- Decision: NotABug
- Reason: The reported code is not an index validation; it’s a length-vs-capacity check. For the unencrypted symlink case, disk_link->len is set to len + 1 to include the NUL terminator, and then compared against max_len using “>”. According to the function’s contract, max_len is the available space to store the symlink target. Allowing equality (i.e., len + 1 == max_len) is correct because the data exactly fits the available space. This matches the encrypted branch’s behavior too, where the helper enforces the length not to exceed the reduced maximum and equality is permitted. There is no subsequent array indexing based on this check, so it does not match the target bug pattern (off-by-one index validation with array bounds), and there is no real out-of-bounds risk here.
