- Decision: NotABug
- Reason: The flagged instance (e.g., arch/x86/kvm/x86.c: kvm_arch_vcpu_ioctl) is not the target pattern of copying a pure array with memdup_user(user_ptr, n * sizeof(*elem)). In KVM ioctls like KVM_SET_MSRS or KVM_SET_CPUID2, the code copies a header plus a flexible-array member, with size computed as sizeof(header) + n * sizeof(entry). The correct hardened pattern for such cases is struct_size() combined with vmemdup_user(), not memdup_array_user(), since the buffer includes both the header and the array. Additionally, the number of entries n is tightly bounded (e.g., by KVM_MAX_* constants), making n * sizeof(entry) far below any overflow thresholds on supported architectures. Therefore, this report does not match the specified target bug pattern and does not represent a real overflow risk in practice.
