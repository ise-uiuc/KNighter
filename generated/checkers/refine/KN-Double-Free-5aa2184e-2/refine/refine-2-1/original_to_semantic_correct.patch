--- original_code.cpp+++ semantic_correct_refine_code.cpp@@ -196,7 +196,7 @@       const FunctionDecl *FD = CE->getDirectCallee();
       if (!FD) return false;
       StringRef Name = FD->getName();
-      if (Name.equals("kfree") || Name.equals("kvfree") || Name.equals("vfree")) {
+      if (Name.equals("kfree") || Name.equals("kvfree")) {
         if (CE->getNumArgs() >= 1) { OutIdx = 0; return true; }
       } else if (Name.equals("devm_kfree")) {
         if (CE->getNumArgs() >= 2) { OutIdx = 1; return true; }
@@ -432,8 +432,8 @@     return false;

   StringRef Name = FD->getName();
-  // Exact matches only; avoid substring matches like "devm_kfree" triggering "kfree".
-  if (Name.equals("kfree") || Name.equals("kvfree") || Name.equals("vfree")) {
+  // Only consider heap-free routines tied to the target pattern; exclude vfree().
+  if (Name.equals("kfree") || Name.equals("kvfree")) {
     if (Call.getNumArgs() >= 1)
       Idxs.push_back(0);
   } else if (Name.equals("devm_kfree")) {
